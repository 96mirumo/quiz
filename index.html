<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Daily Study Log</title>
    <style>
        :root { --bg: #ffffff; --text: #333; --border: #eee; --accent: #444; }
        body { font-family: -apple-system, sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 20px; line-height: 1.6; }
        .container { max-width: 500px; margin: 0 auto; }
        .hidden { display: none !important; }
        
        /* 메인 메뉴 스타일 */
        .menu-card { 
            background: #fff; border: 1px solid var(--border); border-radius: 8px; 
            padding: 15px; margin-bottom: 10px; cursor: pointer;
            display: flex; justify-content: space-between; align-items: center;
        }
        .score-badge { font-size: 0.8rem; color: #888; background: #f9f9f9; padding: 2px 8px; border-radius: 10px; }
        
        /* 퀴즈 UI */
        .quiz-header { display: flex; justify-content: space-between; font-size: 0.8rem; color: #999; margin-bottom: 15px; }
        .q-card { border: 1px solid var(--border); padding: 20px; border-radius: 8px; text-align: center; }
        .q-text { font-size: 1.05rem; font-weight: 600; margin-bottom: 25px; word-break: keep-all; }
        
        /* 입력 및 선택지 */
        input[type="text"] { 
            width: 90%; padding: 12px; border: 1px solid #ddd; border-radius: 4px; 
            font-size: 1rem; margin-bottom: 15px; text-align: center; outline: none;
        }
        .option-btn { 
            display: block; width: 100%; padding: 12px; margin-bottom: 8px; 
            border: 1px solid #ddd; background: #fff; border-radius: 4px; cursor: pointer; text-align: left;
        }
        
        /* 하단 버튼 */
        .btn-row { display: flex; gap: 8px; margin-top: 15px; }
        .btn { flex: 1; padding: 14px; border-radius: 4px; border: 1px solid #ddd; background: #f5f5f5; cursor: pointer; font-size: 0.9rem; }
        .btn-next { background: var(--accent); color: #fff; border: none; }
        
        .status-msg { height: 20px; font-size: 0.85rem; margin-bottom: 10px; font-weight: bold; }
        .nav-link { display: block; text-align: center; margin-top: 30px; color: #aaa; font-size: 0.8rem; cursor: pointer; }
    </style>
</head>
<body>
    <div class="container">
        <div id="view-menu">
            <div style="height: 30px;"></div>
            <div id="set-list"></div>
            <div class="nav-link" onclick="resetScores()">점수 기록 초기화</div>
        </div>

        <div id="view-quiz" class="hidden">
            <div class="quiz-header">
                <span id="display-title"></span>
                <span id="display-progress"></span>
            </div>
            <div class="q-card">
                <div id="status-msg" class="status-msg"></div>
                <div id="q-text" class="q-text"></div>
                
                <div id="area-subjective">
                    <input type="text" id="user-ans" placeholder="정답 입력" autocomplete="off">
                </div>
                
                <div id="area-objective" class="hidden"></div>

                <div id="hint-box" class="hidden" style="background:#f9f9f9; padding:10px; font-size:0.85rem; margin:10px 0; border:1px dashed #ddd;"></div>

                <div class="btn-row" id="row-check">
                    <button class="btn" onclick="toggleHint()">Info</button>
                    <button class="btn" id="btn-verify" onclick="checkAnswer()">Verify</button>
                </div>
                <div class="btn-row hidden" id="row-next">
                    <button class="btn" onclick="toggleHint()">Info</button>
                    <button class="btn btn-next" onclick="nextQuestion()">Next Stage</button>
                </div>
            </div>
            <div class="nav-link" onclick="goHome()">그만 풀고 목록으로</div>
        </div>
    </div>

    <script>
        // PDF 마무리 특강 핵심 반영 (총 60문제 예시)
        const allQuestions = [
            // 1세트: 공학 및 방법론
            { q: "소프트웨어 공학의 3R 중 '분석 -> 재구성 -> 역공학 -> 이관'의 절차를 가지는 것은?", a: ["재공학"], h: "Re-Engineering", type: "S" },
            { q: "애자일 방법론 중 XP의 5가지 핵심 가치가 아닌 것은?", a: ["가시성"], opts: ["용기", "존중", "가시성", "피드백"], h: "용기, 단순성, 커뮤니케이션, 피드백, 존중", type: "O" },
            { q: "비용 산정 기법 중 Rayleigh-Norden 곡선을 기초로 하는 수학적 모델은?", a: ["putnam", "푸트남"], h: "SLIM 도구 사용", type: "S" },
            { q: "요구사항 개발 프로세스 순서로 옳은 것은?", a: ["도출-분석-명세-확인"], opts: ["분석-도출-명세-확인", "도출-분석-명세-확인", "도출-명세-분석-확인"], h: "도분명확", type: "O" },
            { q: "메시지 기반의 비동기식 전송을 하는 미들웨어는?", a: ["MOM"], h: "Message Oriented Middleware", type: "S" },
            { q: "UML 관계 중 전체 객체가 소멸하면 부분 객체도 함께 소멸하는 관계는?", a: ["합성 관계", "합성"], h: "Composition (검은 마름모)", type: "S" },
            { q: "아키텍처 4+1 뷰 중 시스템의 물리적 배치를 나타내는 뷰는?", a: ["배치 뷰"], h: "Deployment View", type: "S" },
            { q: "GoF 디자인 패턴 중 '생성 패턴'에 속하는 것은?", a: ["Builder"], opts: ["Adapter", "Facade", "Builder", "Proxy"], h: "추빌팩프싱 (추상팩토리, 빌더, 팩토리메서드, 프로토타입, 싱글톤)", type: "O" },
            { q: "객체지향 설계 원칙(SOLID) 중 '자식 클래스는 부모 클래스를 대체할 수 있어야 한다'는 원칙은?", a: ["LSP", "리스코프 치환 원칙"], h: "Liskov Substitution Principle", type: "S" },
            { q: "UI 설계 원칙 중 '누구나 쉽게 배우고 익힐 수 있어야 함'을 의미하는 것은?", a: ["학습성"], h: "Understandability", type: "S" },
            // ... (실제 데이터는 60개까지 확장 가능, 여기서는 구조만 10개만 예시로 작성)
            { q: "모듈 내 요소들이 순차적으로 출력을 입력으로 사용하는 응집도는?", a: ["순차적 응집도"], h: "Sequential Cohesion", type: "S" },
            { q: "결합도가 가장 높은(안 좋은) 단계는?", a: ["내용 결합도"], h: "Content Coupling", type: "S" }
        ];

        let currentSet = [];
        let curIdx = 0;
        let setNum = 0;
        let correctCount = 0;

        // 메인 메뉴 렌더링
        function renderMenu() {
            const list = document.getElementById('set-list');
            list.innerHTML = '';
            for(let i=1; i<=3; i++) {
                const lastScore = localStorage.getItem(`score_1_${i}`) || "-";
                list.innerHTML += `
                    <div class="menu-card" onclick="startSet(${i})">
                        <div>
                            <div style="font-weight:bold;">1단원 - 세트 ${i}</div>
                            <div style="font-size:0.75rem; color:#999;">20개 문제 풀기</div>
                        </div>
                        <div class="score-badge">${lastScore}점</div>
                    </div>`;
            }
        }

        function startSet(n) {
            setNum = n;
            curIdx = 0;
            correctCount = 0;
            
            // 문제 랜덤 셔플 후 20개 추출 (실제 데이터 부족 시 전체 셔플)
            currentSet = [...allQuestions].sort(() => Math.random() - 0.5).slice(0, 20);
            
            document.getElementById('view-menu').classList.add('hidden');
            document.getElementById('view-quiz').classList.remove('hidden');
            loadQuestion();
        }

        function loadQuestion() {
            const q = currentSet[curIdx];
            document.getElementById('display-title').innerText = `1단원 - 세트 ${setNum}`;
            document.getElementById('display-progress').innerText = `${curIdx + 1} / ${currentSet.length}`;
            document.getElementById('q-text').innerText = q.q;
            document.getElementById('status-msg').innerText = '';
            document.getElementById('hint-box').classList.add('hidden');
            document.getElementById('row-next').classList.add('hidden');
            document.getElementById('row-check').classList.remove('hidden');

            if(q.type === "S") {
                document.getElementById('area-subjective').classList.remove('hidden');
                document.getElementById('area-objective').classList.add('hidden');
                const input = document.getElementById('user-ans');
                input.value = '';
                setTimeout(() => input.focus(), 150);
            } else {
                document.getElementById('area-subjective').classList.add('hidden');
                const objArea = document.getElementById('area-objective');
                objArea.classList.remove('hidden');
                objArea.innerHTML = '';
                q.opts.forEach(opt => {
                    objArea.innerHTML += `<button class="option-btn" onclick="checkObjective('${opt}')">${opt}</button>`;
                });
            }
        }

        // 주관식 채점 (공백/대소문자 무시)
        function checkAnswer() {
            const user = document.getElementById('user-ans').value.trim().toLowerCase().replace(/\s+/g, '');
            const q = currentSet[curIdx];
            const isCorrect = q.a.some(ans => ans.toLowerCase().replace(/\s+/g, '') === user);
            
            showResult(isCorrect);
        }

        // 객관식 채점
        function checkObjective(val) {
            const q = currentSet[curIdx];
            showResult(q.a.includes(val));
        }

        function showResult(isCorrect) {
            const msg = document.getElementById('status-msg');
            if(isCorrect) {
                msg.innerText = "✓ 확인됨";
                msg.style.color = "#aaa";
                correctCount++;
            } else {
                msg.innerText = `✕ 미일치 (정답: ${currentSet[curIdx].a[0]})`;
                msg.style.color = "#d9534f";
            }
            document.getElementById('row-check').classList.add('hidden');
            document.getElementById('row-next').classList.remove('hidden');
        }

        function nextQuestion() {
            if(curIdx < currentSet.length - 1) {
                curIdx++;
                loadQuestion();
            } else {
                const finalScore = Math.round((correctCount / currentSet.length) * 100);
                alert(`세트 종료! 점수: ${finalScore}점`);
                localStorage.setItem(`score_1_${setNum}`, finalScore);
                goHome();
            }
        }

        function toggleHint() {
            const box = document.getElementById('hint-box');
            box.innerText = currentSet[curIdx].h;
            box.classList.toggle('hidden');
            if(currentSet[curIdx].type === "S") document.getElementById('user-ans').focus();
        }

        function goHome() { location.reload(); }
        function resetScores() { localStorage.clear(); location.reload(); }

        renderMenu();
    </script>
</body>
</html>
